---
outline: deep
lastUpdated: true
---



# Control Flow and Subroutines

::: info Complete Lab Manual
For the complete experiment including learning objectives, theoretical background, and detailed explanations, download the PDF manual:
 [**Download Experiment 3 PDF**](https://raw.githubusercontent.com/mabushelbaia/encs4110/main/manual/encs4110_03.pdf)
:::


## Examples

### Example 1: Find Maximum Element in Array
This example demonstrates how to find the maximum element in an array using a standard for loop structure.

<<< @/snippets/assembly/exp3/example1.asm

**Check:** Verify that the maximum element is correctly identified and stored in `MAXRES`.

### Example 2: Count Uppercase Letters in String
This example demonstrates how to process a null-terminated string and count the number of uppercase letters (A-Z) using a while-loop structure.

<<< @/snippets/assembly/exp3/example2.asm

**Check:** Verify that the program correctly counts the uppercase letters and stores the result in `UPPERCOUNT`.

### Example 3: Nested Uppercase Counter with Stack
This example demonstrates a nested call: `CountUpperNested(ptr)` scans a null-terminated string and calls `IsUpper(ch)` for each character. It shows saving/restoring `LR` and using a callee-saved register (`R4`) for the running count.

<<< @/snippets/assembly/exp3/example3.asm

**Check:** Verify that `UPPERCOUNT` contains `5` for the test string.
## Tasks

### Task 1: Count Vowels in a String
Implement procedures to process strings with the following requirements:
- Create a procedure `CountVowels` that takes a string pointer in R0 and returns the number of vowels (a, e, i, o, u) in R0.
- Use nested procedure calls where `CountVowels` calls a helper procedure `IsVowel`.
- Follow AAPCS conventions for parameter passing and register usage.

#### Task 2: Factorial Calculation (Iterative)
Implement a procedure to calculate the factorial of a non-negative integer:
- Create a procedure `Factorial` that takes a non-negative integer in R0 and returns its factorial in R0.
- Use an iterative approach with a loop to compute the factorial.
- Ensure proper handling of edge cases, such as 0! = 1.
- Follow AAPCS conventions for parameter passing and register usage.

### Task 3: Factorial Calculation (Recursive)
Implement a recursive version of the factorial calculation:
- Create a procedure `FactorialRec` that takes a non-negative integer in R0 and returns its factorial in R0.
- Use recursion to compute the factorial, ensuring proper base case handling.
- Manage the stack appropriately to save and restore registers as needed.
- Follow AAPCS conventions for parameter passing and register usage.
- Test the procedure with various inputs to verify correctness.